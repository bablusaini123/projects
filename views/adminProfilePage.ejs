<!DOCTYPE html>
<html lang="en">

<head>
  <title>Project Management - makeMybiz Admin</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" type="text/css" href="../css/adminx.css" media="screen" />
</head>

<body>
  <div class="adminx-container">
    <%- include("../partials/header.ejs")%>

      <!-- expand-hover push -->
      <!-- Sidebar -->

      <!-- Sidebar End -->
      <%- include("../partials/dashboard.ejs")%>
        <!-- Sidebar -->

        <!-- Sidebar End -->

        <!-- Main Content -->
        <div class="adminx-content">
          <div class="adminx-main-content">
            <div class="container-fluid">
              <!-- BreadCrumb -->
              <nav aria-label="breadcrumb" role="navigation">
                <ol class="breadcrumb adminx-page-breadcrumb">
                  <li class="breadcrumb-item"><a href="#">Home</a></li>
                  <li class="breadcrumb-item"><a href="#">Dashboard</a></li>
                  <li class="breadcrumb-item active  aria-current=" page">Admin Profile Page </li>
                </ol>
              </nav>

              <div class="pb-3">
                <h1></h1>
              </div>

              <div class="row">
                <div class="col-lg-12">
                  <div class="card mb-grid">
                    <div class="card-header d-flex justify-content-between align-items-center">
                      <div class="card-header-title">Admin Profile	</div>

                      <nav class="card-header-actions">
                        <a class="card-header-action" data-toggle="collapse" href="#card1" aria-expanded="false"
                          aria-controls="card1">
                          <i data-feather="minus-circle"></i>
                        </a>
                        <!--                       
                      <div class="dropdown">
                        <a class="card-header-action" href="#" role="button" id="card1Settings" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          <i data-feather="settings"></i>
                        </a>

                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="card1Settings">
                          <a class="dropdown-item" href="#">Action</a>
                          <a class="dropdown-item" href="#">Another action</a>
                          <a class="dropdown-item" href="#">Something else here</a>
                        </div>
                      </div> -->

                        <!-- <a href="#" class="card-header-action">
                        <i data-feather="x-circle"></i>
                      </a> -->
                      </nav>
                    </div>
                    <div class="card-body collapse show" id="card1">
                      <div class="row">
                        <div class="col-md-4">
                          <div class="form-group">
                            <label class="form-label" for="exampleInputEmail1">Type</label>
                            <input readonly value="Admin" id="name" required name="name" type="Name"
                              class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp"
                              placeholder="Enter Customer Name">

                          </div>
                          <div class="form-group">
                            <label class="form-label" for="exampleInputEmail1">Email</label>
                            <input readonly value="<%=result.email%>" required name="email" type="text"
                              class="form-control" id="phone_no" aria-describedby="emailHelp"
                              placeholder="Enter Mobile number">
                          </div>
                          <div class="form-group">
                            <label class="form-label" for="exampleInputEmail1">Current Password</label>
                            <input readonly value="<%=result.password%>"   required name="password" type="text"
                              class="form-control" id="phone_no" aria-describedby="emailHelp"
                              placeholder="Enter New Password">
                          </div>

                        </div>
                        <div class="col-md-2">

                        </div>
                        <div class="col-md-6 ">
                          <h4>Change Your Details</h4>

                          <label for="" id="errorLabel" class="text-danger"></label>

                          <form action="/changeAdminDetails" method="post" id="form">
                            <div class="form-group">
                              <label class="form-label" for="exampleInputEmail1">Email</label>
                              <input value="<%=result.email%>" required name="email" type="email"
                                class="form-control" id="email" aria-describedby="emailHelp"
                                placeholder="Enter Mobile number" >
                            </div>

                            <div class="form-group">
                              <label class="form-label" for="exampleInputEmail1">Update Password</label>
                              <input value="<%=result.password%>"   required name="password" type="text"
                                class="form-control" id="password" aria-describedby="emailHelp"
                                placeholder="Enter New Password">
                            </div>
                            <button type="submit" class="btn btn-primary">update</button>
                          </form>
                         

                        </div>







                      </div>
                    </div>
                  </div>


                </div>
              </div>
            </div>
          </div>
          <!-- // Main Content -->
        </div>

        <!-- If you prefer jQuery these are the required scripts -->
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js"></script>
        <script src="../js/vendor.js"></script>
        <script src="../js/adminx.js"></script>



     

        <!-- If you prefer vanilla JS these are the only required scripts -->
        <!-- script src="../dist/js/vendor.js"></script>
    <script src="../dist/js/adminx.vanilla.js"></script-->

        <script>
          // Example starter JavaScript for disabling form submissions if there are invalid fields
          (function () {
            'use strict';

            window.addEventListener('load', function () {
              var form = document.getElementById('needs-validation');
              if (form !== null) {
                form.addEventListener('submit', function (event) {
                  if (form.checkValidity() === false) {
                    event.preventDefault();
                    event.stopPropagation();
                  }
                  form.classList.add('was-validated');
                }, false);
              }
            }, false);
          })();
        </script>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script>

  let errorLabel = document.getElementById("errorLabel");

  let form = document.getElementById("form");


  //  let form = document.getElementById('form');
  form.addEventListener("submit", (e) => {
    let email = $("#email").val();
    let password = $("#password").val();
    e.preventDefault();
    $.ajax({
      url: `http://localhost:5000/changeAdminDetails`,
      method: "post",
      contentType: "application/x-www-form-urlencoded",
      data: {
        email,
        password,
      },
      success: function (res) {
        console.log(res)
      
          window.location = `http://localhost:5000/adminProfile`
     

      },
      error: function (error) {
        console.log(error);
        if (
          error.responseJSON.data ===
          "Internal error occured: this email is already axist"
        ) {
          errorLabel.style.display = "block";
          errorLabel.innerHTML = "this email is already axist";
        } 
      },
    });
  });
</script>
</body>

</html>